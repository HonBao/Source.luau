local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
local humanoid = character:FindFirstChildOfClass("Humanoid")

local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local ToggleButton = Instance.new("TextButton")
local MenuFrame = Instance.new("Frame")
local UIListLayout = Instance.new("UIListLayout")
local TitleLabel = Instance.new("TextLabel")

-- Cài đặt giao diện chính
ScreenGui.Parent = player:WaitForChild("PlayerGui")

MainFrame.Size = UDim2.new(0, 300, 0, 50)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -25)
MainFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
MainFrame.Parent = ScreenGui

ToggleButton.Size = UDim2.new(1, 0, 1, 0)
ToggleButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
ToggleButton.Text = "Hon"
ToggleButton.Parent = MainFrame

-- Cài đặt giao diện menu
MenuFrame.Size = UDim2.new(0, 300, 0, 400)
MenuFrame.Position = UDim2.new(0.5, -150, 0.5, -200)
MenuFrame.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
MenuFrame.Visible = false
MenuFrame.Parent = ScreenGui

TitleLabel.Size = UDim2.new(1, 0, 0, 50)
TitleLabel.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
TitleLabel.Text = "Menu"
TitleLabel.Parent = MenuFrame

-- Cài đặt danh sách nút
UIListLayout.Parent = MenuFrame

local function toggleMenu()
    MenuFrame.Visible = not MenuFrame.Visible
end

ToggleButton.MouseButton1Click:Connect(toggleMenu)

-- Hàm tự động farm
function autoFarm()
    print("Bắt đầu auto farm...")
    local function getNearestEnemies()
        local enemies = {}
        for _, v in pairs(game.Workspace.Enemies:GetChildren()) do
            if v:FindFirstChild("HumanoidRootPart") and v:FindFirstChild("Humanoid") and v.Humanoid.Health > 0 then
                table.insert(enemies, v)
            end
        end
        return enemies
    end

    local function attackEnemies(enemies)
        for _, enemy in pairs(enemies) do
            humanoidRootPart.CFrame = enemy.HumanoidRootPart.CFrame * CFrame.new(0, 0, 2)
            game:GetService("VirtualUser"):CaptureController()
            game:GetService("VirtualUser"):Button1Down(Vector2.new(0, 0))
            wait(0.1)
        end
    end

    local function acceptQuest()
        local npc = game.Workspace:FindFirstChild("QuestGiverNPC") -- Thay đổi tên NPC
        if npc then
            humanoidRootPart.CFrame = npc.HumanoidRootPart.CFrame
            wait(0.5)
            fireclickdetector(npc:FindFirstChild("ClickDetector"))
        end
    end

    while wait(0.3) do
        local enemies = getNearestEnemies()
        if #enemies > 0 then
            attackEnemies(enemies)
        else
            acceptQuest() -- Nhận nhiệm vụ nếu không còn quái
            wait(2)
        end
    end
end

-- Thêm nút auto farm vào menu
local farmButton = Instance.new("TextButton")
farmButton.Size = UDim2.new(1, 0, 0, 50)
farmButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
farmButton.Text = "Bắt đầu Auto Farm"
farmButton.Parent = MenuFrame

farmButton.MouseButton1Click:Connect(autoFarm)
